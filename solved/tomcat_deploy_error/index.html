<!doctype html><html><head><meta charset=utf-8><meta name=description content="Aloha! Welcome to cheon's blog."><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=76x76 href=https://number317.github.io/blog/img/apple-touch-icon.png><link rel=icon href=https://number317.github.io/blog/img/pen.svg><link rel=stylesheet href=https://number317.github.io/blog/css/global.css><link rel=stylesheet href=https://number317.github.io/blog/css/nav.css><link rel=stylesheet href=https://number317.github.io/blog/css/header.css><link rel=stylesheet href=https://number317.github.io/blog/css/index.css><link rel=stylesheet href=https://number317.github.io/blog/css/list.css><link rel=stylesheet href=https://number317.github.io/blog/css/single.css><link rel=stylesheet href=https://number317.github.io/blog/css/footer.css><link href="https://fonts.googleapis.com/css?family=Fira+Mono|Noto+Sans+SC|Old+Standard+TT&display=swap" rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><title>cheon's blog</title></head><body><section id=header><ul id=menus><li class=menu><a href=https://number317.github.io><span>Home</span></a></li><li class=menu><a href=https://number317.github.io/blog/categories><span>Categories</span></a></li><li class=menu><a href=https://number317.github.io/blog/tags><span>Tags</span></a></li><li class=menu><a href=https://github.com/number317><span>Projects</span></a></li></ul><h1 id=title><a href=https://number317.github.io/blog/>cheon's blog</a></h1></section><ul id=nav><li>»
<a href=https://number317.github.io/blog/>cheon's blog</a></li><li>»
<a href=https://number317.github.io/blog/solved/>solved</a></li><li class=active>»
<a href=https://number317.github.io/blog/solved/tomcat_deploy_error/>Tomcat Deploy Error</a></li></ul><div id=content><main id=main><h1>Tomcat Deploy Error</h1><time>Last updated Fri Jun 14, 2019</time><div><aside><h2>Table of Content</h1><nav id=TableOfContents><ul><li><a href=#错误1>错误1</a></li><li><a href=#错误2>错误2</a></li></ul></nav></aside><article id=content><h1 id=tomcat部署war包出错>tomcat部署war包出错</h1><h2 id=错误1>错误1</h2><p>错误日志如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Caused by: java.lang.IllegalStateException: Unable to complete the scan for annotations for web application [/capitalplan] due to a StackOverflowError. Possible root causes include a too low setting for -Xss and illegal cyclic inheritance dependencies. The class hierarchy being processed was [org.bouncycastle.asn1.ASN1EncodableVector-&gt;org.bouncycastle.asn1.DEREncodableVector-&gt;org.bouncycastle.asn1.ASN1EncodableVector]
</span></span><span style=display:flex><span>	at org.apache.catalina.startup.ContextConfig.checkHandlesTypes(ContextConfig.java:2099)
</span></span><span style=display:flex><span>	at org.apache.catalina.startup.ContextConfig.processAnnotationsStream(ContextConfig.java:2043)
</span></span><span style=display:flex><span>	at org.apache.catalina.startup.ContextConfig.processAnnotationsJar(ContextConfig.java:1989)
</span></span><span style=display:flex><span>	at org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(ContextConfig.java:1959)
</span></span><span style=display:flex><span>	at org.apache.catalina.startup.ContextConfig.processAnnotations(ContextConfig.java:1912)
</span></span><span style=display:flex><span>	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1154)
</span></span><span style=display:flex><span>	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:771)
</span></span><span style=display:flex><span>	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:298)
</span></span><span style=display:flex><span>	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:94)
</span></span><span style=display:flex><span>	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5093)
</span></span><span style=display:flex><span>	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:152)
</span></span><span style=display:flex><span>	... 10 more
</span></span></code></pre></div><p>解决方案：</p><p>修改conf/catalina.properties:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>tomcat.util.scan.DefaultJarScanner.jarsToSkip=\,*
</span></span></code></pre></div><p>设置不扫描jar包</p><h2 id=错误2>错误2</h2><p>在运行日志里查看不到错误，可以在logs目录下查看localhost.xxx文件，发现报错如下：</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>java.lang.NoSuchMethodError: org.springframework.aop.framework.AopProxyUtils.getSingletonTarget(Ljava/lang/Object;)Ljava/lang/Object;
</span></span></code></pre></div><p>这种错误通常由jar包冲突导致，可以在项目里执行<code>mvn dependency:tree</code>查看项目的依赖情况，在上述的日志中，发现是<code>springframework.aop</code>这个出错，直接查找<code>aop</code>关键字，查看依赖后发现有两个jar包依赖于<code>spring-aop</code>，分别是<code>spring-context.jar:4.3.11.RELEASE</code>依赖于<code>spring-aop.jar:4.3.11.RELEASE</code>;<code>spring-jms.jar:4.3.6.RELEASE</code>依赖于<code>spring-aop.jar:4.3.6.RELEASE</code>，可以明显的看到4.3.6和4.3.11版本冲突了，这里将4.3.6版本修改为4.3.11版本后部署成功。</p></article></div></main><div><h4 id=signature>Tue Feb 6, 2018
cheon</h4><ul class=tags><li><a href=https://number317.github.io/blog/tags/tomcat>tomcat</a></li></ul><ul class=related><li><a class=next href=https://number317.github.io/blog/solved/openshift_restart_node/>Openshift Restart Node</a></li></ul></div></div><section id=footer><div id=author><h2>About Author</h2><hr><img src=https://number317.github.io/images/author.jpg></img><p>Life is dance we all have to do.</p></div><ul id=link><li><a href=https://github.com/number317/aloha.git target=_blank><i class="fa fa-github" alt=github></i></a></li><li><a href="mailto:cheon0112358d@gmail.com?subject=blog%27s%20feedback" target=_blank><i class="fa fa-envelope" alt=email></i></a></li><li id=wechat><i class="fa fa-wechat"></i></li><img class=qrcode src=https://number317.github.io/images/wechat.jpg></ul></section></body></html>