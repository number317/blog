<!doctype html><html><head><meta charset=utf-8><meta name=description content="Aloha! Welcome to cheon's blog."><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=76x76 href=https://number317.github.io/blog/img/apple-touch-icon.png><link rel=icon href=https://number317.github.io/blog/img/pen.svg><link rel=stylesheet href=https://number317.github.io/blog/css/global.css><link rel=stylesheet href=https://number317.github.io/blog/css/nav.css><link rel=stylesheet href=https://number317.github.io/blog/css/header.css><link rel=stylesheet href=https://number317.github.io/blog/css/index.css><link rel=stylesheet href=https://number317.github.io/blog/css/list.css><link rel=stylesheet href=https://number317.github.io/blog/css/single.css><link rel=stylesheet href=https://number317.github.io/blog/css/footer.css><link href="https://fonts.googleapis.com/css?family=Fira+Mono|Noto+Sans+SC|Old+Standard+TT&display=swap" rel=stylesheet><link href=//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><title>cheon's blog</title></head><body><section id=header><ul id=menus><li class=menu><a href=https://number317.github.io><span>Home</span></a></li><li class=menu><a href=https://number317.github.io/blog/categories><span>Categories</span></a></li><li class=menu><a href=https://number317.github.io/blog/tags><span>Tags</span></a></li><li class=menu><a href=https://github.com/number317><span>Projects</span></a></li></ul><h1 id=title><a href=https://number317.github.io/blog/>cheon's blog</a></h1></section><ul id=nav><li>»
<a href=https://number317.github.io/blog/>cheon's blog</a></li><li>»
<a href=https://number317.github.io/blog/struct/>struct</a></li><li class=active>»
<a href=https://number317.github.io/blog/struct/org_blog_with_hugo/>用 hugo 组织 org 文件写博客</a></li></ul><div id=content><main id=main><h1>用 hugo 组织 org 文件写博客</h1><time>Last updated Tue Dec 17, 2024</time><div><aside><h2>Table of Content</h1><nav id=TableOfContents><ul><li><a href=#从-markdown-到-org>从 markdown 到 org</a></li><li><a href=#org-原型模板>org 原型模板</a></li><li><a href=#可折叠代码块>可折叠代码块</a></li><li><a href=#图片路径>图片路径</a><ul><li><a href=#hugo-version--0810>hugo version &lt; 0.81.0</a></li><li><a href=#hugo-version--0810-1>hugo version >= 0.81.0</a></li><li><a href=#hugo-version--0830>hugo version >= 0.83.0</a></li></ul></li></ul></nav></aside><article id=content><h1 id=用-hugo-组织-org-文件写博客>用 hugo 组织 org 文件写博客</h1><h2 id=从-markdown-到-org>从 markdown 到 org</h2><p>首先需要使用 <code>hugo</code> 来构建网站，没有接触过的可以查看<a href=https://gohugo.io/getting-started/quick-start/>官方文档</a></p><p>用 <code>hugo</code> 来写博客的常见都是 <code>markdown</code> 格式，但在 <code>hugo</code> 中，需要在头部添加一些信息用于 <code>hugo</code> 构建，这就会导致 <code>markdown</code> 在单独渲染的时候头部会有多余的信息。尤其是在 <code>github</code> 的网站上，看着让人很难受。</p><p>并且随着 <code>hugo</code> 的迭代，可能对于 <code>markdwon</code> 的解析也有些变动，之前在 <code>markdwon</code> 里写的一些原生 <code>html</code> 解析格式不太对，导致折叠的代码格式混乱。之前很多文章都有这个问题。最近正好在摸索着使用 <code>emacs</code> 来写代码，索性换成 <code>org</code> 格式了。</p><h2 id=org-原型模板>org 原型模板</h2><p>在 <code>archetypes</code> 目录下创建 <code>default.org</code> 文件，之后在用 <code>hugo new test.org</code> 的时候就会使用改文件为原型。文件内容具体如下：</p><pre><code>#+title: {{ replace .TranslationBaseName &quot;_&quot; &quot; &quot; | title}}
#+summary: article summary
#+url: /url.html
#+author: cheon
#+email: cheon0112358d@gmail.com
#+date: {{ .Date }}
#+publishdate: {{ .Date }}
#+tags: tags
#+categories: categories
#+draft: true
</code></pre><p>参数解析：</p><ul><li><code>#+title</code>: 根据文件名生成文档标题，具体规则是把文件名中的 &ldquo;_&rdquo; 替换为 " " 然后将每个单词首字母大写</li><li><code>#+summary</code>: 文档的概要</li><li><code>#+url</code>: 指定文档生成的 <code>url</code></li><li><code>+tags</code>: 文档的标签</li><li><code>+categories</code>: 文档的类别</li><li><code>+draft</code>: 是否是草稿，草稿在构建时默认不会渲染成 <code>html</code></li></ul><p>注意在 <code>hugo</code> 构建或者运行时，可能会看到</p><blockquote><p><code>Please use '#+tags[]:' notation, automatic conversion is deprecated.</code></p><p><code>Please use '#+categories[]:' notation, automatic conversion is deprecated.</code></p></blockquote><p>类似警告，可以忽略，不影响文档的渲染。如果照提示修改，反而会导致 <code>org</code> 文件在 github 网站上头部信息显示异常。</p><h2 id=可折叠代码块>可折叠代码块</h2><p>写文档的时候一个常用的功能是代码块，当代码太长的时候需要可以折叠。这个在 <code>org</code> 中可以用原生 <code>html</code> 的 <code>&lt;detail></code> 标签来实现。</p><details><summary>可折叠代码块实现</summary><pre><code>#+begin_export html
&lt;details&gt;
&lt;summary&gt;summary&lt;/summary&gt;
#+end_export

#+begin_src
在这里写代码
#+end_src

#+begin_export html
&lt;/details&gt;
#+end_export
</code></pre></details><p>但是每次写这么一大堆也比较麻烦，所以可以用 <code>yasnippet</code> 来管理片段。在 <code>emacs</code> 中按下 <code>M-x</code> 执行 <code>yas-new-snippet</code> 并填入一下内容</p><details><summary>code</summary><pre><code># -*- mode: snippet -*-
# name: org mode collapsable code block
# key: code
# --

#+begin_export html
&lt;details&gt;
&lt;summary&gt;$1&lt;/summary&gt;
#+end_export

#+begin_src $2
$3
#+end_src

#+begin_export html
&lt;/details&gt;
#+end_export
</code></pre></details><p>将文件保存到 <code>org-mode/code</code> 文件，以后在写 <code>org</code> 文档时，只要输入 <code>code</code> 再按下 <code>tab</code> 键就会生成这段代码</p><h2 id=图片路径>图片路径</h2><p>写文档插入图片也是不可缺少的。通常我会把图片放到和文档同级的目录中，然后在文档里直接用相对路径引用，这样在 <code>github</code> 上也能正确显示图片。</p><p>文件和图片的目录结构如下：</p><pre><code>./content/post/
├── _index.org
├── post1.org
├── post2.org
├── post3.org
└── images
   ├── post1_1.png
   ├── post1_2.png
   └── post2_1.jpg

1 directory, 7 files
</code></pre><h3 id=hugo-version--0810>hugo version &lt; 0.81.0</h3><p>在 <code>hugo v0.81.0</code> 之前，需要在 org 文档的头信息中添加 <code>url</code> 信息来修改默认生成的地址，以便在编译之后能找到对应的图片，例如</p><pre><code>#+url: /post/post1.html
</code></pre><p>这种情况下，编译出的目录结构如下：</p><pre><code>./post/
├── index.html
├── index.xml
├── post1.html
├── post2.html
├── post3.html
├── images
│   ├── post1_1.png
│   ├── post2_2.png
│   └── post2_1.jpg
└── page
    └── 1
        └── index.html

3 directories, 9 files
</code></pre><h3 id=hugo-version--0810-1>hugo version >= 0.81.0</h3><p>在 <code>hugo v0.81.0</code> 以及之后，使用的 <code>go-org</code> 依赖升级到了 <code>v1.4.0</code> 版本，使用相对路径的引用都会默认加上 <code>../</code> 前缀，所以用默认生成的地址就可以了，而不需要在文档的头信息中添加 <code>url</code> 信息，具体可以查看该 <a href=https://github.com/gohugoio/hugo/pull/8111>pull request</a> 。</p><p><img src=https://number317.github.io/blog/struct/images/org_blog_with_hugo_2.jpg alt=img></p><p>这种情况下，编译出的目录结构如下：</p><pre><code>./struct/
├── post1
│   └── index.html
├── post2
│   └── index.html
├── post3
│   └── index.html
└── images
    ├── post1_1.png
    ├── post1_2.png
    └── post2_1.jpg

4 directories, 6 files
</code></pre><h3 id=hugo-version--0830>hugo version >= 0.83.0</h3><p>经过测试，hugo 在 <a href=https://github.com/gohugoio/hugo/releases/tag/v0.83.0>0.83.0</a> 版本将 go-org 依赖升级到了 v1.5.0 后，使用相对路径的引用都会默认加上 <code>../</code> 前缀这个特性已经没了。也没见到哪里有说明，那就恢复成原来的改写 url 方式吧。</p><p>图片测试：</p><p><img src=https://number317.github.io/blog/struct/images/org_blog_with_hugo_1.jpg alt=img></p><p>如果上面的图片还能看到，说明当前的 <code>hugo</code> 还能使用这种方法，否则需要去看看是否有改动再另行调整。</p><p>PS: 现在还是切换回了 markdown 格式和 vim 编辑器。emacs 用了一年多个人感觉还是更偏爱 vim。</p></article></div></main><div><h4 id=signature>Mon Sep 14, 2020
cheon</h4><ul class=tags><li><a href=https://number317.github.io/blog/tags/hugo>hugo</a></li><li><a href=https://number317.github.io/blog/tags/org>org</a></li></ul><ul class=related><li><a class=previous href=https://number317.github.io/blog/struct/k8s_note/>K8s Note</a></li><li><a class=next href=https://number317.github.io/blog/struct/emqx_backend_mysql/>Emqx Backend Mysql</a></li></ul></div></div><section id=footer><div id=author><h2>About Author</h2><hr><img src=https://number317.github.io/images/author.jpg></img><p>Life is dance we all have to do.</p></div><ul id=link><li><a href=https://github.com/number317/aloha.git target=_blank><i class="fa fa-github" alt=github></i></a></li><li><a href="mailto:cheon0112358d@gmail.com?subject=blog%27s%20feedback" target=_blank><i class="fa fa-envelope" alt=email></i></a></li><li id=wechat><i class="fa fa-wechat"></i></li><img class=qrcode src=https://number317.github.io/images/wechat.jpg></ul></section></body></html>