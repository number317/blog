<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="description" content=Aloha!&#32;Welcome&#32;to&#32;cheon&#39;s&#32;blog.>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon" sizes= "76x76" href=https://number317.github.io/blog/img/apple-touch-icon.png>
    <link rel="icon" href=https://number317.github.io/blog/img/pen.svg>
    <link rel="stylesheet" href=https://number317.github.io/blog/css/global.css>
    <link rel="stylesheet" href=https://number317.github.io/blog/css/nav.css>
    <link rel="stylesheet" href=https://number317.github.io/blog/css/header.css>
    <link rel="stylesheet" href=https://number317.github.io/blog/css/index.css>
    <link rel="stylesheet" href=https://number317.github.io/blog/css/list.css>
    <link rel="stylesheet" href=https://number317.github.io/blog/css/single.css>
    <link rel="stylesheet" href=https://number317.github.io/blog/css/footer.css>
    
    <link href="https://fonts.googleapis.com/css?family=Fira+Mono|Noto+Sans+SC|Old+Standard+TT&display=swap" rel="stylesheet">
    
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <title>cheon&#39;s blog</title>

</head>
<body><section id="header">
    <ul id="menus">
    
    <li class="menu"><a href="https://number317.github.io"><span>Home</span></a></li>
    
    <li class="menu"><a href="https://number317.github.io/blog/categories"><span>Categories</span></a></li>
    
    <li class="menu"><a href="https://number317.github.io/blog/tags"><span>Tags</span></a></li>
    
    <li class="menu"><a href="https://github.com/number317"><span>Projects</span></a></li>
    
    </ul>
    <h1 id="title"><a href="https://number317.github.io/blog/">cheon&#39;s blog</a></h1>
</section>
<ul id="nav">






<li>
    »
    <a href="https://number317.github.io/blog/">
    
    cheon&#39;s blog
    
    </a>
</li>


<li>
    »
    <a href="https://number317.github.io/blog/categories/struct/">
    
    struct
    
    
    </a>
</li>


<li class="active">
    »
    <a href="https://number317.github.io/blog/struct/org_blog_with_hugo.html">
    
    Org Blog With Hugo
    
    </a>
</li>

</ul>

<div id="content">
<main id="main">
  <h1>Org Blog With Hugo</h1>
  <time>Last updated Sun May 7, 2023</time>
  <div>
      <aside>
          <h2>Table of Content</h1>
          <nav id="TableOfContents">
<ul>
<li><a href="#headline-1">用 hugo 组织 org 文件写博客</a>
<ul>
<li><a href="#headline-2">从 markdown 到 org</a>
</li>
<li><a href="#headline-3">org 原型模板</a>
</li>
<li><a href="#headline-4">可折叠代码块</a>
</li>
<li><a href="#headline-5">图片路径</a>
<ul>
<li><a href="#headline-6">hugo version &lt; 0.81.0 </a>
</li>
<li><a href="#headline-7">hugo version &gt;= 0.81.0 </a>
</li>
<li><a href="#headline-8">hugo version &gt;= 0.83.0</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
      </aside>
      <article id="content">
          
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
用 hugo 组织 org 文件写博客
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
从 markdown 到 org
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<p>
首先需要使用 <code class="verbatim">hugo</code> 来构建网站，没有接触过的可以查看<a href="https://gohugo.io/getting-started/quick-start/">官方文档</a></p>
<p>
用 <code class="verbatim">hugo</code> 来写博客的常见都是 <code class="verbatim">markdown</code> 格式，但在 <code class="verbatim">hugo</code> 中，需要在头部添加一些信息用于 <code class="verbatim">hugo</code> 构建，这就会导致 <code class="verbatim">markdown</code> 在单独渲染的时候头部会有多余的信息。尤其是在 <code class="verbatim">github</code> 的网站上，看着让人很难受。</p>
<p>
并且随着 <code class="verbatim">hugo</code> 的迭代，可能对于 <code class="verbatim">markdwon</code> 的解析也有些变动，之前在 <code class="verbatim">markdwon</code> 里写的一些原生 <code class="verbatim">html</code> 解析格式不太对，导致折叠的代码格式混乱。之前很多文章都有这个问题。最近正好在摸索着使用 <code class="verbatim">emacs</code> 来写代码，索性换成 <code class="verbatim">org</code> 格式了。</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
org 原型模板
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<p>
在 <code class="verbatim">archetypes</code> 目录下创建 <code class="verbatim">default.org</code> 文件，之后在用 <code class="verbatim">hugo new test.org</code> 的时候就会使用改文件为原型。文件内容具体如下：</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-org" data-lang="org"><span style="display:flex;"><span>  #+title: {{ replace .TranslationBaseName &#34;_&#34; &#34; &#34; | title}}
</span></span><span style="display:flex;"><span>  #+summary: article summary
</span></span><span style="display:flex;"><span>  #+url: /url.html
</span></span><span style="display:flex;"><span>  #+author: cheon
</span></span><span style="display:flex;"><span>  #+email: cheon0112358d@gmail.com
</span></span><span style="display:flex;"><span>  #+date: {{ .Date }}
</span></span><span style="display:flex;"><span>  #+publishdate: {{ .Date }}
</span></span><span style="display:flex;"><span>  #+tags: tags
</span></span><span style="display:flex;"><span>  #+categories: categories
</span></span><span style="display:flex;"><span>  #+draft: true</span></span></code></pre></div>
</div>
<p>
参数解析：</p>
<ul>
<li><code class="verbatim">#+title</code>: 根据文件名生成文档标题，具体规则是把文件名中的 &#34;_&#34; 替换为 &#34; &#34; 然后将每个单词首字母大写</li>
<li><code class="verbatim">#+summary</code>: 文档的概要</li>
<li><code class="verbatim">#+url</code>: 指定文档生成的 <code class="verbatim">url</code></li>
<li><code class="verbatim">+tags</code>: 文档的标签</li>
<li><code class="verbatim">+categories</code>: 文档的类别</li>
<li><code class="verbatim">+draft</code>: 是否是草稿，草稿在构建时默认不会渲染成 <code class="verbatim">html</code></li>
</ul>
<p>注意在 <code class="verbatim">hugo</code> 构建或者运行时，可能会看到</p>
<blockquote>
<p><code class="verbatim">Please use &#39;#+tags[]:&#39; notation, automatic conversion is deprecated.</code></p>
<p>
<code class="verbatim">Please use &#39;#+categories[]:&#39; notation, automatic conversion is deprecated.</code></p>
</blockquote>
<p>
类似警告，可以忽略，不影响文档的渲染。如果照提示修改，反而会导致 <code class="verbatim">org</code> 文件在 github 网站上头部信息显示异常。</p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
可折叠代码块
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<p>
写文档的时候一个常用的功能是代码块，当代码太长的时候需要可以折叠。这个在 <code class="verbatim">org</code> 中可以用原生 <code class="verbatim">html</code> 的 <code class="verbatim">&lt;detail&gt;</code> 标签来实现。</p>
<details>
<summary>可折叠代码块实现</summary>
<pre class="example">
#+begin_export html
&lt;details&gt;
&lt;summary&gt;summary&lt;/summary&gt;
#+end_export

#+begin_src
在这里写代码
#+end_src

#+begin_export html
&lt;/details&gt;
#+end_export
</pre>
</details>
<p>
但是每次写这么一大堆也比较麻烦，所以可以用 <code class="verbatim">yasnippet</code> 来管理片段。在 <code class="verbatim">emacs</code> 中按下 <code class="verbatim">M-x</code> 执行 <code class="verbatim">yas-new-snippet</code> 并填入一下内容</p>
<details>
<summary>code</summary>
<pre class="example">
# -*- mode: snippet -*-
# name: org mode collapsable code block
# key: code
# --

#+begin_export html
&lt;details&gt;
&lt;summary&gt;$1&lt;/summary&gt;
#+end_export

#+begin_src $2
$3
#+end_src

#+begin_export html
&lt;/details&gt;
#+end_export
</pre>
</details>
<p>
将文件保存到 <code class="verbatim">org-mode/code</code> 文件，以后在写 <code class="verbatim">org</code> 文档时，只要输入 <code class="verbatim">code</code> 再按下 <code class="verbatim">tab</code> 键就会生成这段代码</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
图片路径
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<p>
写文档插入图片也是不可缺少的。通常我会把图片放到和文档同级的目录中，然后在文档里直接用相对路径引用，这样在 <code class="verbatim">github</code> 上也能正确显示图片。</p>
<p>
文件和图片的目录结构如下：</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  ./content/post/
</span></span><span style="display:flex;"><span>  ├── _index.org
</span></span><span style="display:flex;"><span>  ├── post1.org
</span></span><span style="display:flex;"><span>  ├── post2.org
</span></span><span style="display:flex;"><span>  ├── post3.org
</span></span><span style="display:flex;"><span>  └── images
</span></span><span style="display:flex;"><span>     ├── post1_1.png
</span></span><span style="display:flex;"><span>     ├── post1_2.png
</span></span><span style="display:flex;"><span>     └── post2_1.jpg
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  1 directory, 7 files</span></span></code></pre></div>
</div>
<div id="outline-container-headline-6" class="outline-4">
<h4 id="headline-6">
hugo version &lt; 0.81.0 
</h4>
<div id="outline-text-headline-6" class="outline-text-4">
<p>
在 <code class="verbatim">hugo v0.81.0</code> 之前，需要在 org 文档的头信息中添加 <code class="verbatim">url</code> 信息来修改默认生成的地址，以便在编译之后能找到对应的图片，例如</p>
<div class="src src-org">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-org" data-lang="org"><span style="display:flex;"><span>  #+url: /post/post1.html</span></span></code></pre></div>
</div>
<p>
这种情况下，编译出的目录结构如下：</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  ./post/
</span></span><span style="display:flex;"><span>  ├── index.html
</span></span><span style="display:flex;"><span>  ├── index.xml
</span></span><span style="display:flex;"><span>  ├── post1.html
</span></span><span style="display:flex;"><span>  ├── post2.html
</span></span><span style="display:flex;"><span>  ├── post3.html
</span></span><span style="display:flex;"><span>  ├── images
</span></span><span style="display:flex;"><span>  │   ├── post1_1.png
</span></span><span style="display:flex;"><span>  │   ├── post2_2.png
</span></span><span style="display:flex;"><span>  │   └── post2_1.jpg
</span></span><span style="display:flex;"><span>  └── page
</span></span><span style="display:flex;"><span>      └── 1
</span></span><span style="display:flex;"><span>          └── index.html
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  3 directories, 9 files</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-7" class="outline-4">
<h4 id="headline-7">
hugo version &gt;= 0.81.0 
</h4>
<div id="outline-text-headline-7" class="outline-text-4">
<p>
在 <code class="verbatim">hugo v0.81.0</code> 以及之后，使用的 <code class="verbatim">go-org</code> 依赖升级到了 <code class="verbatim">v1.4.0</code> 版本，使用相对路径的引用都会默认加上 <code class="verbatim">../</code> 前缀，所以用默认生成的地址就可以了，而不需要在文档的头信息中添加 <code class="verbatim">url</code> 信息，具体可以查看该 <a href="https://github.com/gohugoio/hugo/pull/8111">pull request</a> 。</p>
<p>
<img src="./images/org_blog_with_hugo_2.jpg" alt="./images/org_blog_with_hugo_2.jpg" title="./images/org_blog_with_hugo_2.jpg" /></p>
<p>
这种情况下，编译出的目录结构如下：</p>
<div class="src src-bash">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  ./struct/
</span></span><span style="display:flex;"><span>  ├── post1
</span></span><span style="display:flex;"><span>  │   └── index.html
</span></span><span style="display:flex;"><span>  ├── post2
</span></span><span style="display:flex;"><span>  │   └── index.html
</span></span><span style="display:flex;"><span>  ├── post3
</span></span><span style="display:flex;"><span>  │   └── index.html
</span></span><span style="display:flex;"><span>  └── images
</span></span><span style="display:flex;"><span>      ├── post1_1.png
</span></span><span style="display:flex;"><span>      ├── post1_2.png
</span></span><span style="display:flex;"><span>      └── post2_1.jpg
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  4 directories, 6 files</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-8" class="outline-4">
<h4 id="headline-8">
hugo version &gt;= 0.83.0
</h4>
<div id="outline-text-headline-8" class="outline-text-4">
<p>
经过测试，hugo 在 <a href="https://github.com/gohugoio/hugo/releases/tag/v0.83.0">0.83.0</a> 版本将 go-org 依赖升级到了 v1.5.0 后，使用相对路径的引用都会默认加上 <code class="verbatim">../</code> 前缀这个特性已经没了。</p>
<p>
也没见到哪里有说明，那就恢复成原来的改写 url 方式吧。这导致我不太想用 hugo 了，变动太频繁，有空自己搭建一个博客框架。</p>
<p>
图片测试：</p>
<p>
<img src="./images/org_blog_with_hugo_1.jpg" alt="./images/org_blog_with_hugo_1.jpg" title="./images/org_blog_with_hugo_1.jpg" /></p>
<p>
如果上面的图片还能看到，说明当前的 <code class="verbatim">hugo</code> 还能使用这种方法，否则需要去看看是否有改动再另行调整。</p>
</div>
</div>
</div>
</div>
</div>
</div>

      </article>
  </div>
</main>

<div>
    <h4 id="signature">
        Mon Sep 14, 2020
        
            cheon
        
    </h4>
    
    
    <ul class="tags">
        
            <li> <a href="https://number317.github.io/blog/tags/hugo">hugo</a> </li>
        
            <li> <a href="https://number317.github.io/blog/tags/org">org</a> </li>
        
    </ul>
    
    <ul class="related">
        
        
            <li><a class="next" href="https://number317.github.io/blog/struct/emqx_backend_mysql.html"> Emqx Backend Mysql</a></li>
        
    </ul>
</div>

        </div><section id="footer">

<div id="author">
    <h2>About Author</h2>
    <hr>
    <img src=https://number317.github.io/images/author.jpg></img>
    <p>Life is dance we all have to do.</p>
</div>
<ul id="link">
    <li><a href=https://github.com/number317/aloha.git target="_blank"><i class="fa fa-github" alt="github"></i></a></li>
    <li><a href="mailto:cheon0112358d@gmail.com?subject=blog%27s%20feedback" target="_blank"><i class="fa fa-envelope" alt="email"></i></a></li>
    <li id="wechat"><i class="fa fa-wechat"></i></li>
    <img class="qrcode" src=https://number317.github.io/images/wechat.jpg>
</ul>
</section>
</body>
</html>
