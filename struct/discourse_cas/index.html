<!doctype html><html><head><meta charset=utf-8><meta name=description content="Aloha! Welcome to cheon's blog."><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=76x76 href=https://number317.github.io/blog/img/apple-touch-icon.png><link rel=icon href=https://number317.github.io/blog/img/pen.svg><link rel=stylesheet href=https://number317.github.io/blog/css/global.css><link rel=stylesheet href=https://number317.github.io/blog/css/nav.css><link rel=stylesheet href=https://number317.github.io/blog/css/header.css><link rel=stylesheet href=https://number317.github.io/blog/css/index.css><link rel=stylesheet href=https://number317.github.io/blog/css/list.css><link rel=stylesheet href=https://number317.github.io/blog/css/single.css><link rel=stylesheet href=https://number317.github.io/blog/css/footer.css><link href="https://fonts.googleapis.com/css?family=Fira+Mono|Noto+Sans+SC|Old+Standard+TT&display=swap" rel=stylesheet><link href=https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><script src=https://number317.github.io/blog/js/single.js></script><title>cheon's blog</title></head><body><section id=header><ul id=menus><li class=menu><a href=https://number317.github.io><span>Home</span></a></li><li class=menu><a href=https://number317.github.io/blog/categories><span>Categories</span></a></li><li class=menu><a href=https://number317.github.io/blog/tags><span>Tags</span></a></li><li class=menu><a href=https://github.com/number317><span>Projects</span></a></li></ul><h1 id=title><a href=https://number317.github.io/blog/>cheon's blog</a></h1></section><ul id=nav><li>»
<a href=https://number317.github.io/blog/>cheon's blog</a></li><li>»
<a href=https://number317.github.io/blog/struct/>struct</a></li><li class=active>»
<a href=https://number317.github.io/blog/struct/discourse_cas/>Discourse Cas</a></li></ul><div id=content><main id=main><h1>Discourse Cas</h1><time>Last updated Tue Dec 17, 2024</time><div><aside><h2>Table of Content</h1><nav id=TableOfContents><ul><li><a href=#插件安装>插件安装</a></li><li><a href=#插件配置>插件配置</a></li></ul></nav></aside><article id=content><h1 id=discourse-cas-登录配置>discourse cas 登录配置</h1><h2 id=插件安装>插件安装</h2><p>cas插件使用<a href=https://github.com/tyl3k/cas_sso.git>tyl3k/cas_sso</a>，在<code>discourse.yml</code>中添加<code>git clone https://github.com/tyl3k/cas_sso.git</code>:</p><div class="code-block code-block-container-indented"><pre><code id=code-24733f00c8f9d3f53bc04f42df0a39c2>hooks:
  after_code:
    - exec:
        cd: $home/plugins
        cmd:
          - git clone https://github.com/discourse/docker_manager.git
          - git clone https://github.com/tyl3k/cas_sso.git
          - git clone https://github.com/discourse/discourse-solved.git
          - git clone https://github.com/discoursehosting/discourse-sitemap.git</code></pre><button class=copy-code-button onclick='copyCode("code-24733f00c8f9d3f53bc04f42df0a39c2",this)' title=copy>
<i class="fa fa-copy"></i></button></div><p>修改好配置文件后重新构建discourse镜像:</p><div class="code-block code-block-container-indented"><pre><code id=code-c391b4bb7972e86f3cfe964f2a2c05eb>./launcher rebuild discourse</code></pre><button class=copy-code-button onclick='copyCode("code-c391b4bb7972e86f3cfe964f2a2c05eb",this)' title=copy>
<i class="fa fa-copy"></i></button></div><p>镜像构建完毕以上命令会自动启动discourse</p><h2 id=插件配置>插件配置</h2><p>以管理员帐号进入discourse设置界面:</p><p><img src=https://number317.github.io/blog/struct/images/discourse_cas_img1.png alt=进入设置界面></p><p><img src=https://number317.github.io/blog/struct/images/discourse_cas_img2.png alt=cas设置></p><ul><li>cas sso url: <a href=https://login.xxx.com/sso>https://login.xxx.com/sso</a></li><li>cas sso host: login.xxx.com</li><li>cas sso service validate url: /p3/serviceValidate</li><li>cas sso email domain: xxx.com</li><li>cas sso user auto create: 不勾选</li><li>cas sso user approved: 不勾选</li></ul><p>退出登录后，点击登录，可以看到有cas登录选项的按钮：</p><p><img src=https://number317.github.io/blog/struct/images/discourse_cas_img3.png alt=cas登录></p></article></div></main><div><h4 id=signature>Mon Oct 23, 2017
cheon</h4><ul class=tags><li><a href=https://number317.github.io/blog/tags/discourse>discourse</a></li></ul><ul class=related><li><a class=previous href=https://number317.github.io/blog/struct/discourse_deploy/>Discourse Deploy</a></li><li><a class=next href=https://number317.github.io/blog/struct/discourse_digest/>Discourse Digest</a></li></ul></div></div><section id=footer><div id=author><h2>About Author</h2><hr><img src=https://number317.github.io/images/author.jpg></img><p>Life is dance we all have to do.</p></div><ul id=link><li><a href=https://github.com/number317/aloha.git target=_blank><i class="fa fa-github" alt=github></i></a></li><li><a href="mailto:cheon0112358d@gmail.com?subject=blog%27s%20feedback" target=_blank><i class="fa fa-envelope" alt=email></i></a></li><li id=wechat><i class="fa fa-wechat"></i></li><img class=qrcode src=https://number317.github.io/images/wechat.jpg></ul></section></body></html>